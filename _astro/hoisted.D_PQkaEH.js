import"./hoisted.rrRgbaP2.js";import{u as f}from"./relativeTime.Cw4JtWda.js";import{_ as g}from"./preload-helper.CLcXU_4U.js";class w{phase=0;offset=0;frequency=.001;amplitude=1;constructor(t){this.phase=t.phase||0,this.offset=t.offset||0,this.frequency=t.frequency||.001,this.amplitude=t.amplitude||1}update(){return this.phase+=this.frequency,this.offset+Math.sin(this.phase)*this.amplitude}}class E{x=0;y=0;vy=0;vx=0}class L{constructor(t,e){this.pos=e,this.spring=t.spring+.1*Math.random()-.05,this.friction=h.friction+.01*Math.random()-.005,this.nodes=[];for(let n=0;n<h.size;n++){const o=new E;o.x=this.pos.x,o.y=this.pos.y,this.nodes.push(o)}}spring=.1;friction=.01;nodes=[];update(){let t=this.spring,e=this.nodes[0];e.vx+=(this.pos.x-e.x)*t,e.vy+=(this.pos.y-e.y)*t;let n;for(let o=0;o<this.nodes.length;o++)e=this.nodes[o],0<o&&(n=this.nodes[o-1],e.vx+=(n.x-e.x)*t,e.vy+=(n.y-e.y)*t,e.vx+=n.vx*h.dampening,e.vy+=n.vy*h.dampening),e.vx*=this.friction,e.vy*=this.friction,e.x+=e.vx,e.y+=e.vy,t*=h.tension}draw(t){let e,n,o=this.nodes[0].x,i=this.nodes[0].y;t.beginPath(),t.moveTo(o,i);let s;for(s=1;s<this.nodes.length-2;s++)e=this.nodes[s],n=this.nodes[s+1],o=.5*(e.x+n.x),i=.5*(e.y+n.y),t.quadraticCurveTo(e.x,e.y,o,i);e=this.nodes[s],n=this.nodes[s+1],t.quadraticCurveTo(e.x,e.y,n.x,n.y),t.stroke(),t.closePath()}}const h={friction:.5,trails:20,size:50,dampening:.25,tension:.98},x=function(){const t=document.getElementById("canvas").getContext("2d");let e=[];const n={x:0,y:0},o=new w({phase:Math.random()*2*Math.PI,amplitude:85,frequency:.0015,offset:285});let i=!0;function s(){t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight}s();function r(){if(i){t.globalCompositeOperation="source-over",t.clearRect(0,0,t.canvas.width,t.canvas.height),t.globalCompositeOperation="lighter",t.strokeStyle="hsla("+Math.round(o.update())+",90%,50%,0.25)",t.lineWidth=1;for(let c=0;c<h.trails;c++){const l=e[c];l.update(),l.draw(t)}window.requestAnimationFrame(r)}}function u(c){function l(){e=[];for(let d=0;d<h.trails;d++)e.push(new L({spring:.45+d/h.trails*.025},n))}function v(d){"touches"in d?(n.x=d.touches[0].pageX,n.y=d.touches[0].pageY):(n.x=d.clientX,n.y=d.clientY),d.preventDefault()}function m(d){d.touches&&d.touches.length===1&&(n.x=d.touches[0].pageX,n.y=d.touches[0].pageY)}document.removeEventListener("mousemove",u),document.removeEventListener("touchstart",u),document.addEventListener("mousemove",v),document.addEventListener("touchmove",v),document.addEventListener("touchstart",m),v(c),l(),r()}document.addEventListener("mousemove",u),document.addEventListener("touchstart",u),document.body.addEventListener("orientationchange",s),window.addEventListener("resize",s),window.addEventListener("focus",()=>{i||(i=!0,r())}),window.addEventListener("blur",()=>{i=!0})};document.addEventListener("astro:page-load",()=>{document.getElementById("canvas")&&x()});document.addEventListener("astro:page-load",()=>{const a=document.getElementById("scrollButtonContainer"),t=new IntersectionObserver(n=>{n.forEach(o=>{o.isIntersecting?a?.classList.add("hidden"):a?.classList.remove("hidden")})},{root:null,threshold:.1}),e=document.querySelector("#about");e&&t.observe(e),a?.addEventListener("click",()=>{const n=document.querySelector("#about");n&&n.scrollIntoView({behavior:"smooth"})})});document.addEventListener("astro:page-load",()=>{f()});async function b(){const a=document.getElementById("typedElement");if(!a)return;const{default:t}=await g(async()=>{const{default:i}=await import("./typed.module.vdGjvGsj.js");return{default:i}},[]),e={strings:["老麦幽居处，柴扉向晓开。","清风梳翠柳，暖日抚青苔。","乐观、坚持；梦，近在咫尺。"],typeSpeed:80,backSpeed:50,backDelay:5e3,loop:!0,showCursor:!0,cursorChar:"|"},n=new t(a,e),o=()=>{n.destroy(),window.removeEventListener("astro:before-swap",o)};window.addEventListener("astro:before-swap",o)}document.addEventListener("astro:page-load",()=>{b()});function y(){const a=document.getElementById("avatarContainer"),t=document.getElementById("avatar");!a||!t||(a.addEventListener("mousemove",e=>{if(window.innerWidth<1280)return;const{clientX:n,clientY:o}=e,{width:i,height:s,x:r,y:u}=a.getBoundingClientRect(),c=Math.abs(n-r),l=Math.abs(o-u),v=-15,m=15,d=m-v,p={x:m-l/s*d,y:v+c/i*d};t.style.transform=`rotateX(${p.x}deg) rotateY(${p.y}deg)`}),a.addEventListener("mouseleave",()=>{t.style.transform="rotateX(0deg) rotateY(0deg)"}))}document.addEventListener("astro:page-load",y);document.addEventListener("astro:after-swap",y);document.addEventListener("astro:page-load",()=>{f();const a=document.querySelectorAll(".lazy-media"),t=new IntersectionObserver((e,n)=>{e.forEach(o=>{if(o.isIntersecting){const i=o.target;if(i.tagName==="IMG"){const s=i,r=s.getAttribute("data-full-url");r&&!s.dataset.loaded&&(s.src=r,s.dataset.loaded="true")}if(i.classList.contains("video-wrapper")){const s=i,r=s.querySelector(".video-player"),u=s.getAttribute("data-full-url"),c=s.getAttribute("data-poster-url");if(r&&c&&!r.dataset.posterLoaded&&(r.setAttribute("poster",c),r.dataset.posterLoaded="true"),r&&u&&!r.dataset.loaded){const l=r.querySelector("source");l&&(l.src=u,r.load(),r.dataset.loaded="true")}}n.unobserve(i)}})});a.forEach(e=>t.observe(e))});
