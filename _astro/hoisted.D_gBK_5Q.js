import"./hoisted.rrRgbaP2.js";import{u as f}from"./relativeTime.Cw4JtWda.js";import{_ as g}from"./preload-helper.CLcXU_4U.js";class E{phase=0;offset=0;frequency=.001;amplitude=1;constructor(n){this.phase=n.phase||0,this.offset=n.offset||0,this.frequency=n.frequency||.001,this.amplitude=n.amplitude||1}update(){return this.phase+=this.frequency,this.offset+Math.sin(this.phase)*this.amplitude}}class w{x=0;y=0;vy=0;vx=0}class L{constructor(n,e){this.pos=e,this.spring=n.spring+.1*Math.random()-.05,this.friction=v.friction+.01*Math.random()-.005,this.nodes=[];for(let t=0;t<v.size;t++){const o=new w;o.x=this.pos.x,o.y=this.pos.y,this.nodes.push(o)}}spring=.1;friction=.01;nodes=[];update(){let n=this.spring,e=this.nodes[0];e.vx+=(this.pos.x-e.x)*n,e.vy+=(this.pos.y-e.y)*n;let t;for(let o=0;o<this.nodes.length;o++)e=this.nodes[o],0<o&&(t=this.nodes[o-1],e.vx+=(t.x-e.x)*n,e.vy+=(t.y-e.y)*n,e.vx+=t.vx*v.dampening,e.vy+=t.vy*v.dampening),e.vx*=this.friction,e.vy*=this.friction,e.x+=e.vx,e.y+=e.vy,n*=v.tension}draw(n){let e,t,o=this.nodes[0].x,d=this.nodes[0].y;n.beginPath(),n.moveTo(o,d);let s;for(s=1;s<this.nodes.length-2;s++)e=this.nodes[s],t=this.nodes[s+1],o=.5*(e.x+t.x),d=.5*(e.y+t.y),n.quadraticCurveTo(e.x,e.y,o,d);e=this.nodes[s],t=this.nodes[s+1],n.quadraticCurveTo(e.x,e.y,t.x,t.y),n.stroke(),n.closePath()}}const v={friction:.5,trails:20,size:50,dampening:.25,tension:.98},b=function(){const n=document.getElementById("canvas").getContext("2d");let e=[];const t={x:0,y:0},o=new E({phase:Math.random()*2*Math.PI,amplitude:85,frequency:.0015,offset:285});let d=!0;function s(){n.canvas.width=window.innerWidth,n.canvas.height=window.innerHeight}s();function u(){if(d){n.globalCompositeOperation="source-over",n.clearRect(0,0,n.canvas.width,n.canvas.height),n.globalCompositeOperation="lighter",n.strokeStyle="hsla("+Math.round(o.update())+",90%,50%,0.25)",n.lineWidth=1;for(let c=0;c<v.trails;c++){const i=e[c];i.update(),i.draw(n)}window.requestAnimationFrame(u)}}function l(c){function i(){e=[];for(let r=0;r<v.trails;r++)e.push(new L({spring:.45+r/v.trails*.025},t))}function h(r){"touches"in r?(t.x=r.touches[0].pageX,t.y=r.touches[0].pageY):(t.x=r.clientX,t.y=r.clientY),r.preventDefault()}function m(r){r.touches&&r.touches.length===1&&(t.x=r.touches[0].pageX,t.y=r.touches[0].pageY)}document.removeEventListener("mousemove",l),document.removeEventListener("touchstart",l),document.addEventListener("mousemove",h),document.addEventListener("touchmove",h),document.addEventListener("touchstart",m),h(c),i(),u()}document.addEventListener("mousemove",l),document.addEventListener("touchstart",l),document.body.addEventListener("orientationchange",s),window.addEventListener("resize",s),window.addEventListener("focus",()=>{d||(d=!0,u())}),window.addEventListener("blur",()=>{d=!0})};document.addEventListener("astro:page-load",()=>{document.getElementById("canvas")&&b()});document.addEventListener("astro:page-load",()=>{const a=document.getElementById("scrollButtonContainer"),n=new IntersectionObserver(t=>{t.forEach(o=>{o.isIntersecting?a?.classList.add("hidden"):a?.classList.remove("hidden")})},{root:null,threshold:.1}),e=document.querySelector("#about");e&&n.observe(e),a?.addEventListener("click",()=>{const t=document.querySelector("#about");t&&t.scrollIntoView({behavior:"smooth"})})});document.addEventListener("astro:page-load",()=>{f()});async function x(){const a=document.getElementById("typedElement");if(!a)return;const{default:n}=await g(async()=>{const{default:d}=await import("./typed.module.vdGjvGsj.js");return{default:d}},[]),e={strings:["老麦幽居处，柴扉向晓开。","清风梳翠柳，暖日抚青苔。","乐观、坚持；梦，近在咫尺。"],typeSpeed:80,backSpeed:50,backDelay:5e3,loop:!0,showCursor:!0,cursorChar:"|"},t=new n(a,e),o=()=>{t.destroy(),window.removeEventListener("astro:before-swap",o)};window.addEventListener("astro:before-swap",o)}document.addEventListener("astro:page-load",()=>{x()});function y(){const a=document.getElementById("avatarContainer"),n=document.getElementById("avatar");!a||!n||(a.addEventListener("mousemove",e=>{if(window.innerWidth<1280)return;const{clientX:t,clientY:o}=e,{width:d,height:s,x:u,y:l}=a.getBoundingClientRect(),c=Math.abs(t-u),i=Math.abs(o-l),h=-15,m=15,r=m-h,p={x:m-i/s*r,y:h+c/d*r};n.style.transform=`rotateX(${p.x}deg) rotateY(${p.y}deg)`}),a.addEventListener("mouseleave",()=>{n.style.transform="rotateX(0deg) rotateY(0deg)"}))}document.addEventListener("astro:page-load",y);document.addEventListener("astro:after-swap",y);document.addEventListener("astro:page-load",()=>{f();const a=document.querySelectorAll(".lazy-media"),n=new IntersectionObserver((s,u)=>{s.forEach(l=>{if(l.isIntersecting){const c=l.target;if(c.tagName==="IMG"){const i=c,h=i.getAttribute("data-full-url");h&&!i.dataset.loaded&&(i.src=h,i.dataset.loaded="true")}u.unobserve(c)}})});a.forEach(s=>n.observe(s));const e=document.querySelectorAll(".video-wrapper"),t=document.querySelector(".video-modal"),o=t?.querySelector(".video-container"),d=t?.querySelector(".video-modal-close");!t||!o||!d?console.error("Missing required elements: modal, modalContent, or closeButton"):(e.forEach(s=>{const u=s.querySelector(".video-play-button"),l=s.querySelector("img")?.getAttribute("data-full-url"),c=s.querySelector("img")?.getAttribute("data-poster-url");u&&l&&u.addEventListener("click",()=>{const i=document.createElement("video");i.src=l,i.className="video-player",i.controls=!0,i.preload="auto",i.autoplay=!0,i.playsInline=!0,i.style.width="100%",i.style.height="100%",i.style.objectFit="cover",c&&(i.poster=c),o.innerHTML="",o.appendChild(i),t.classList.remove("hidden")})}),d.addEventListener("click",()=>{t.classList.add("hidden"),o.innerHTML=""}),t.addEventListener("click",s=>{s.target===t&&(t.classList.add("hidden"),o.innerHTML="")}))});
